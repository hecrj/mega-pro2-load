\hypertarget{main_8cpp}{
\section{main.cpp File Reference}
\label{main_8cpp}\index{main.cpp@{main.cpp}}
}


Main program of the download system.  


Include dependency graph for main.cpp:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=400pt]{main_8cpp__incl}
\end{center}
\end{figure}
\subsection*{Defines}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{main_8cpp_a46f6c8442705607f2c61f490da4e4b52}{OPT\_\-SYS\_\-END}~0
\item 
\#define \hyperlink{main_8cpp_ae2b02e2eac1ca1126a29d5b02091d995}{OPT\_\-NEW\_\-REQ}~1
\item 
\#define \hyperlink{main_8cpp_ad8ae9168505ba8901c203a8e41a015a3}{OPT\_\-UNF\_\-REQ}~2
\item 
\#define \hyperlink{main_8cpp_a548187fd4d9e7f14a1697144c44b93a0}{OPT\_\-BUS\_\-SER}~3
\item 
\#define \hyperlink{main_8cpp_ad8ed9f61d78009dec0002fdd54b11a71}{OPT\_\-UPD\_\-SER}~4
\item 
\#define \hyperlink{main_8cpp_a305e556838cb1b31fc0759cffe52e4d5}{OPT\_\-MSD\_\-MOV}~5
\item 
\#define \hyperlink{main_8cpp_ad0519c14b2cf10c0f2fd8013920ae4a4}{OPT\_\-SHW\_\-HEL}~6
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{main_8cpp_ab1aba707586fd08c600f483c376459b9}{handle\_\-request} (const MovieCollection \&movies, \hyperlink{class_network}{Network} \&net, \hyperlink{class_request}{Request} \&req)
\begin{DoxyCompactList}\small\item\em Handles a request. \item\end{DoxyCompactList}\item 
void \hyperlink{main_8cpp_ad2aa43f12636f63f16264d9fddb51925}{write\_\-unfinished\_\-requests} (const \hyperlink{class_request_collection}{RequestCollection} \&rcol)
\begin{DoxyCompactList}\small\item\em Outputs information of the unfinished requests. \item\end{DoxyCompactList}\item 
void \hyperlink{main_8cpp_ad3d9ff9cd5214fece1291008e9c818db}{write\_\-busy\_\-servers} (const \hyperlink{class_network}{Network} \&net, const \hyperlink{class_request_collection}{RequestCollection} \&rcol)
\begin{DoxyCompactList}\small\item\em Outputs information of the busy servers. \item\end{DoxyCompactList}\item 
void \hyperlink{main_8cpp_adc45343f5c3bd27a543b22091c2f1e0b}{write\_\-most\_\-downloaded\_\-movie} (const \hyperlink{class_network}{Network} \&router, const MovieCollection \&movies)
\begin{DoxyCompactList}\small\item\em Outputs the most downloaded movie between t1 and t2. \item\end{DoxyCompactList}\item 
void \hyperlink{main_8cpp_ac29c297ae32acdb2172e926d5f144681}{show\_\-help} ()
\begin{DoxyCompactList}\small\item\em Prints main application help. \item\end{DoxyCompactList}\item 
int \hyperlink{main_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}{main} ()
\begin{DoxyCompactList}\small\item\em Starts the main application logic. \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Main program of the download system. 

Definition in file \hyperlink{main_8cpp_source}{main.cpp}.



\subsection{Define Documentation}
\hypertarget{main_8cpp_a46f6c8442705607f2c61f490da4e4b52}{
\index{main.cpp@{main.cpp}!OPT\_\-SYS\_\-END@{OPT\_\-SYS\_\-END}}
\index{OPT\_\-SYS\_\-END@{OPT\_\-SYS\_\-END}!main.cpp@{main.cpp}}
\subsubsection[{OPT\_\-SYS\_\-END}]{\setlength{\rightskip}{0pt plus 5cm}\#define OPT\_\-SYS\_\-END~0}}
\label{main_8cpp_a46f6c8442705607f2c61f490da4e4b52}


Definition at line 21 of file main.cpp.

\hypertarget{main_8cpp_ae2b02e2eac1ca1126a29d5b02091d995}{
\index{main.cpp@{main.cpp}!OPT\_\-NEW\_\-REQ@{OPT\_\-NEW\_\-REQ}}
\index{OPT\_\-NEW\_\-REQ@{OPT\_\-NEW\_\-REQ}!main.cpp@{main.cpp}}
\subsubsection[{OPT\_\-NEW\_\-REQ}]{\setlength{\rightskip}{0pt plus 5cm}\#define OPT\_\-NEW\_\-REQ~1}}
\label{main_8cpp_ae2b02e2eac1ca1126a29d5b02091d995}


Definition at line 22 of file main.cpp.

\hypertarget{main_8cpp_ad8ae9168505ba8901c203a8e41a015a3}{
\index{main.cpp@{main.cpp}!OPT\_\-UNF\_\-REQ@{OPT\_\-UNF\_\-REQ}}
\index{OPT\_\-UNF\_\-REQ@{OPT\_\-UNF\_\-REQ}!main.cpp@{main.cpp}}
\subsubsection[{OPT\_\-UNF\_\-REQ}]{\setlength{\rightskip}{0pt plus 5cm}\#define OPT\_\-UNF\_\-REQ~2}}
\label{main_8cpp_ad8ae9168505ba8901c203a8e41a015a3}


Definition at line 23 of file main.cpp.

\hypertarget{main_8cpp_a548187fd4d9e7f14a1697144c44b93a0}{
\index{main.cpp@{main.cpp}!OPT\_\-BUS\_\-SER@{OPT\_\-BUS\_\-SER}}
\index{OPT\_\-BUS\_\-SER@{OPT\_\-BUS\_\-SER}!main.cpp@{main.cpp}}
\subsubsection[{OPT\_\-BUS\_\-SER}]{\setlength{\rightskip}{0pt plus 5cm}\#define OPT\_\-BUS\_\-SER~3}}
\label{main_8cpp_a548187fd4d9e7f14a1697144c44b93a0}


Definition at line 24 of file main.cpp.

\hypertarget{main_8cpp_ad8ed9f61d78009dec0002fdd54b11a71}{
\index{main.cpp@{main.cpp}!OPT\_\-UPD\_\-SER@{OPT\_\-UPD\_\-SER}}
\index{OPT\_\-UPD\_\-SER@{OPT\_\-UPD\_\-SER}!main.cpp@{main.cpp}}
\subsubsection[{OPT\_\-UPD\_\-SER}]{\setlength{\rightskip}{0pt plus 5cm}\#define OPT\_\-UPD\_\-SER~4}}
\label{main_8cpp_ad8ed9f61d78009dec0002fdd54b11a71}


Definition at line 25 of file main.cpp.

\hypertarget{main_8cpp_a305e556838cb1b31fc0759cffe52e4d5}{
\index{main.cpp@{main.cpp}!OPT\_\-MSD\_\-MOV@{OPT\_\-MSD\_\-MOV}}
\index{OPT\_\-MSD\_\-MOV@{OPT\_\-MSD\_\-MOV}!main.cpp@{main.cpp}}
\subsubsection[{OPT\_\-MSD\_\-MOV}]{\setlength{\rightskip}{0pt plus 5cm}\#define OPT\_\-MSD\_\-MOV~5}}
\label{main_8cpp_a305e556838cb1b31fc0759cffe52e4d5}


Definition at line 26 of file main.cpp.

\hypertarget{main_8cpp_ad0519c14b2cf10c0f2fd8013920ae4a4}{
\index{main.cpp@{main.cpp}!OPT\_\-SHW\_\-HEL@{OPT\_\-SHW\_\-HEL}}
\index{OPT\_\-SHW\_\-HEL@{OPT\_\-SHW\_\-HEL}!main.cpp@{main.cpp}}
\subsubsection[{OPT\_\-SHW\_\-HEL}]{\setlength{\rightskip}{0pt plus 5cm}\#define OPT\_\-SHW\_\-HEL~6}}
\label{main_8cpp_ad0519c14b2cf10c0f2fd8013920ae4a4}


Definition at line 27 of file main.cpp.



\subsection{Function Documentation}
\hypertarget{main_8cpp_ab1aba707586fd08c600f483c376459b9}{
\index{main.cpp@{main.cpp}!handle\_\-request@{handle\_\-request}}
\index{handle\_\-request@{handle\_\-request}!main.cpp@{main.cpp}}
\subsubsection[{handle\_\-request}]{\setlength{\rightskip}{0pt plus 5cm}void handle\_\-request (
\begin{DoxyParamCaption}
\item[{const MovieCollection \&}]{movies, }
\item[{{\bf Network} \&}]{net, }
\item[{{\bf Request} \&}]{req}
\end{DoxyParamCaption}
)}}
\label{main_8cpp_ab1aba707586fd08c600f483c376459b9}


Handles a request. 

Handling a request is a process where the request end time is calculated using free servers, which will be busy until then. \begin{DoxyPrecond}{Precondition}
True 
\end{DoxyPrecond}
\begin{DoxyPostcond}{Postcondition}
The given \hyperlink{class_request}{Request} is handled by the \hyperlink{class_network}{Network}. 
\end{DoxyPostcond}


Definition at line 36 of file main.cpp.


\begin{DoxyCode}
{
  Movie mov = movies.get_movie(req.get_movie_id());
  Route route = net.get_route(mov);

  if(not route.is_empty())
  {
    int time = req.get_time_start() + route.get_travel_time();
    req.set_time_end(time);
    req.set_route(route);

    net.occupy_servers(route, req.get_id());
  }
}
\end{DoxyCode}
\hypertarget{main_8cpp_ad2aa43f12636f63f16264d9fddb51925}{
\index{main.cpp@{main.cpp}!write\_\-unfinished\_\-requests@{write\_\-unfinished\_\-requests}}
\index{write\_\-unfinished\_\-requests@{write\_\-unfinished\_\-requests}!main.cpp@{main.cpp}}
\subsubsection[{write\_\-unfinished\_\-requests}]{\setlength{\rightskip}{0pt plus 5cm}void write\_\-unfinished\_\-requests (
\begin{DoxyParamCaption}
\item[{const {\bf RequestCollection} \&}]{rcol}
\end{DoxyParamCaption}
)}}
\label{main_8cpp_ad2aa43f12636f63f16264d9fddb51925}


Outputs information of the unfinished requests. 

\begin{DoxyPrecond}{Precondition}
True 
\end{DoxyPrecond}
\begin{DoxyPostcond}{Postcondition}
Information of the unfinished requests has been printed in the output stream. 
\end{DoxyPostcond}


Definition at line 57 of file main.cpp.


\begin{DoxyCode}
{

}
\end{DoxyCode}
\hypertarget{main_8cpp_ad3d9ff9cd5214fece1291008e9c818db}{
\index{main.cpp@{main.cpp}!write\_\-busy\_\-servers@{write\_\-busy\_\-servers}}
\index{write\_\-busy\_\-servers@{write\_\-busy\_\-servers}!main.cpp@{main.cpp}}
\subsubsection[{write\_\-busy\_\-servers}]{\setlength{\rightskip}{0pt plus 5cm}void write\_\-busy\_\-servers (
\begin{DoxyParamCaption}
\item[{const {\bf Network} \&}]{net, }
\item[{const {\bf RequestCollection} \&}]{rcol}
\end{DoxyParamCaption}
)}}
\label{main_8cpp_ad3d9ff9cd5214fece1291008e9c818db}


Outputs information of the busy servers. 

\begin{DoxyPrecond}{Precondition}
True 
\end{DoxyPrecond}
\begin{DoxyPostcond}{Postcondition}
Information of the busy servers has been printed in the output stream. 
\end{DoxyPostcond}


Definition at line 68 of file main.cpp.


\begin{DoxyCode}
{

}
\end{DoxyCode}
\hypertarget{main_8cpp_adc45343f5c3bd27a543b22091c2f1e0b}{
\index{main.cpp@{main.cpp}!write\_\-most\_\-downloaded\_\-movie@{write\_\-most\_\-downloaded\_\-movie}}
\index{write\_\-most\_\-downloaded\_\-movie@{write\_\-most\_\-downloaded\_\-movie}!main.cpp@{main.cpp}}
\subsubsection[{write\_\-most\_\-downloaded\_\-movie}]{\setlength{\rightskip}{0pt plus 5cm}void write\_\-most\_\-downloaded\_\-movie (
\begin{DoxyParamCaption}
\item[{const {\bf Network} \&}]{router, }
\item[{const MovieCollection \&}]{movies}
\end{DoxyParamCaption}
)}}
\label{main_8cpp_adc45343f5c3bd27a543b22091c2f1e0b}


Outputs the most downloaded movie between t1 and t2. 

\begin{DoxyPrecond}{Precondition}
t1 $<$ t2, t1 greater than the last entered time 
\end{DoxyPrecond}
\begin{DoxyPostcond}{Postcondition}
The most downloaded movie has been pritend in the output stream. 
\end{DoxyPostcond}


Definition at line 78 of file main.cpp.


\begin{DoxyCode}
{
  
}
\end{DoxyCode}
\hypertarget{main_8cpp_ac29c297ae32acdb2172e926d5f144681}{
\index{main.cpp@{main.cpp}!show\_\-help@{show\_\-help}}
\index{show\_\-help@{show\_\-help}!main.cpp@{main.cpp}}
\subsubsection[{show\_\-help}]{\setlength{\rightskip}{0pt plus 5cm}void show\_\-help (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{main_8cpp_ac29c297ae32acdb2172e926d5f144681}


Prints main application help. 

\begin{DoxyPrecond}{Precondition}
True 
\end{DoxyPrecond}
\begin{DoxyPostcond}{Postcondition}
A help message has been printed on the output stream. 
\end{DoxyPostcond}


Definition at line 88 of file main.cpp.


\begin{DoxyCode}
{
  cout << "Here are the available actions you can choose:" << endl << endl;
  cout << "[1] Create and handle a new request" << endl;
  cout << "[2] See unfinished requests" << endl;
  cout << "[3] See busy servers" << endl;
  cout << "[4] Update a server" << endl;
  cout << "[5] See the most downloaded movie" << endl;
  cout << "[6] Show this help" << endl;
  cout << "[0] Exit" << endl << endl;
}
\end{DoxyCode}
\hypertarget{main_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}{
\index{main.cpp@{main.cpp}!main@{main}}
\index{main@{main}!main.cpp@{main.cpp}}
\subsubsection[{main}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{main_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}


Starts the main application logic. 



Definition at line 103 of file main.cpp.


\begin{DoxyCode}
{
    MovieCollection movies;
    movies.read_movies();

    Network net;
    net.read_network(movies.size());

    RequestCollection rcol;
  
  cout << "MEGA-PRO2-LOAD initialized!" << endl << endl;

  show_help();

  cout << "Choose one action: ";
  int opt = readint();

  while(opt != OPT_SYS_END)
  {
        if(opt == OPT_NEW_REQ)
        {
          Request req;
          req.read_request(rcol.size());

          handle_request(movies, net, req);
          rcol.add_request(req);

          req.write_request();
        }
    else if(opt == OPT_UNF_REQ) write_unfinished_requests(rcol);
    else if(opt == OPT_BUS_SER) write_busy_servers(net, rcol);
    else if(opt == OPT_UPD_SER)
    {
      int server_id = readint();
      net.update_server(server_id);
    }
    else if(opt == OPT_MSD_MOV) write_most_downloaded_movie(net, movies);
    else if(opt == OPT_SHW_HEL) show_help();

    cout << "Choose next action: ";
    opt = readint();
  }

  cout << "MEGA-PRO2-LOAD finished!" << endl;
}
\end{DoxyCode}
